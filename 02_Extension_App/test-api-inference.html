<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>üß™ Cookie Classifier API Test - Standalone</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background: linear-gradient(135deg, #0f1235 0%, #1a1d3f 25%, #0a0c20 75%, #050610 100%);
      color: white;
      min-height: 100vh;
      padding: 40px 20px;
    }
    
    .container {
      max-width: 1200px;
      margin: 0 auto;
    }
    
    h1 {
      font-size: 2.5rem;
      margin-bottom: 0.5rem;
      background: linear-gradient(90deg, #EBFF3D, #4DD4E8);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    
    .subtitle {
      color: rgba(255, 255, 255, 0.6);
      margin-bottom: 2rem;
      font-size: 1.1rem;
    }
    
    .api-info {
      background: rgba(37, 43, 92, 0.5);
      border: 1px solid rgba(235, 255, 61, 0.2);
      border-radius: 12px;
      padding: 20px;
      margin-bottom: 30px;
    }
    
    .api-info h3 {
      color: #EBFF3D;
      margin-bottom: 10px;
    }
    
    .api-info code {
      background: rgba(10, 12, 32, 0.8);
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 0.9rem;
      color: #4DD4E8;
    }
    
    .status {
      padding: 15px 20px;
      margin: 10px 0;
      border-radius: 8px;
      background: rgba(37, 43, 92, 0.5);
      border-left: 4px solid;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .status.success { border-color: #10b981; }
    .status.error { border-color: #ef4444; }
    .status.warning { border-color: #f59e0b; }
    .status.info { border-color: #3b82f6; }
    
    .status-icon {
      font-size: 1.2rem;
    }
    
    .controls {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin: 30px 0;
    }
    
    button {
      padding: 12px 24px;
      background: #EBFF3D;
      color: #1E2366;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 600;
      font-size: 1rem;
      transition: all 0.2s;
    }
    
    button:hover {
      background: #dffb2f;
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(235, 255, 61, 0.3);
    }
    
    button:active {
      transform: translateY(0);
    }
    
    button:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      transform: none;
    }
    
    .input-group {
      display: flex;
      gap: 10px;
      margin: 20px 0;
    }
    
    input[type="text"] {
      flex: 1;
      padding: 12px 16px;
      background: rgba(37, 43, 92, 0.5);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 8px;
      color: white;
      font-size: 1rem;
    }
    
    input[type="text"]:focus {
      outline: none;
      border-color: #EBFF3D;
      box-shadow: 0 0 0 2px rgba(235, 255, 61, 0.1);
    }
    
    input::placeholder {
      color: rgba(255, 255, 255, 0.4);
    }
    
    .results {
      margin-top: 30px;
    }
    
    .result-card {
      background: rgba(37, 43, 92, 0.5);
      border-radius: 12px;
      padding: 20px;
      margin-bottom: 20px;
      border: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    .result-card h3 {
      color: #EBFF3D;
      margin-bottom: 15px;
      font-size: 1.3rem;
    }
    
    pre {
      background: rgba(10, 12, 32, 0.8);
      padding: 20px;
      border-radius: 8px;
      overflow-x: auto;
      font-size: 0.9rem;
      line-height: 1.6;
      color: #4DD4E8;
      border: 1px solid rgba(77, 212, 232, 0.2);
    }
    
    .cookie-result {
      display: flex;
      align-items: center;
      gap: 15px;
      padding: 15px;
      background: rgba(10, 12, 32, 0.5);
      border-radius: 8px;
      margin-bottom: 10px;
      border-left: 4px solid;
    }
    
    .cookie-result.class-0 { border-color: #10b981; }
    .cookie-result.class-1 { border-color: #3b82f6; }
    .cookie-result.class-2 { border-color: #f59e0b; }
    .cookie-result.class-3 { border-color: #ef4444; }
    
    .cookie-name {
      font-family: 'Courier New', monospace;
      font-weight: bold;
      font-size: 1.1rem;
    }
    
    .cookie-category {
      padding: 4px 12px;
      border-radius: 6px;
      font-weight: 600;
      font-size: 0.85rem;
    }
    
    .category-0 { background: rgba(16, 185, 129, 0.2); color: #10b981; }
    .category-1 { background: rgba(59, 130, 246, 0.2); color: #3b82f6; }
    .category-2 { background: rgba(245, 158, 11, 0.2); color: #f59e0b; }
    .category-3 { background: rgba(239, 68, 68, 0.2); color: #ef4444; }
    
    .confidence {
      color: rgba(255, 255, 255, 0.6);
      font-size: 0.9rem;
    }
    
    .loading {
      display: inline-block;
      width: 20px;
      height: 20px;
      border: 3px solid rgba(235, 255, 61, 0.3);
      border-top-color: #EBFF3D;
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }
    
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>üß™ Cookie Classifier API Test</h1>
    <p class="subtitle">Test your Hugging Face serverless API in real-time</p>
    
    <div class="api-info">
      <h3>üöÄ API Endpoint</h3>
      <p><code id="apiUrl">https://aqibtahir-cookie-classifier-api.hf.space</code></p>
      <p style="margin-top: 10px; color: rgba(255, 255, 255, 0.7);">
        Model: Linear Regression (90% accuracy) | Categories: 4 (Strictly Necessary, Functionality, Analytics, Advertising)
      </p>
    </div>
    
    <div id="status"></div>
    
    <div class="input-group">
      <input 
        type="text" 
        id="cookieInput" 
        placeholder="Enter cookie name (e.g., _ga, _gid, sessionid, _fbp)"
        value="_ga"
      >
      <button onclick="classifySingle()">üîç Classify Single Cookie</button>
    </div>
    
    <div class="controls">
      <button onclick="testHealth()">‚ù§Ô∏è Health Check</button>
      <button onclick="testCommonCookies()">üìä Test Common Cookies</button>
      <button onclick="testBatch()">üöÄ Batch Test (10 cookies)</button>
      <button onclick="clearResults()">üóëÔ∏è Clear Results</button>
    </div>
    
    <div class="results" id="results"></div>
  </div>

  <script>
    const API_URL = 'https://aqibtahir-cookie-classifier-api.hf.space';
    const statusDiv = document.getElementById('status');
    const resultsDiv = document.getElementById('results');

    const CATEGORY_ICONS = {
      0: 'üîí',
      1: '‚öôÔ∏è',
      2: 'üìä',
      3: 'üéØ'
    };

    function addStatus(message, type = 'info', loading = false) {
      const div = document.createElement('div');
      div.className = `status ${type}`;
      const icons = { success: '‚úÖ', error: '‚ùå', warning: '‚ö†Ô∏è', info: '‚ÑπÔ∏è' };
      div.innerHTML = `
        <span class="status-icon">${loading ? '<span class="loading"></span>' : icons[type]}</span>
        <span>${message}</span>
      `;
      statusDiv.appendChild(div);
      return div;
    }

    function clearResults() {
      statusDiv.innerHTML = '';
      resultsDiv.innerHTML = '';
      addStatus('Results cleared', 'info');
    }

    async function testHealth() {
      clearResults();
      const statusEl = addStatus('Checking API health...', 'info', true);
      
      try {
        const response = await fetch(`${API_URL}/`);
        const data = await response.json();
        
        statusEl.remove();
        addStatus('‚úÖ API is online and healthy!', 'success');
        
        const card = document.createElement('div');
        card.className = 'result-card';
        card.innerHTML = `
          <h3>Health Check Response</h3>
          <pre>${JSON.stringify(data, null, 2)}</pre>
        `;
        resultsDiv.appendChild(card);
      } catch (error) {
        statusEl.remove();
        addStatus(`API health check failed: ${error.message}`, 'error');
      }
    }

    async function classifySingle() {
      const cookieName = document.getElementById('cookieInput').value.trim();
      
      if (!cookieName) {
        addStatus('Please enter a cookie name', 'warning');
        return;
      }
      
      clearResults();
      const statusEl = addStatus(`Classifying "${cookieName}"...`, 'info', true);
      
      try {
        const response = await fetch(`${API_URL}/predict`, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ cookie_name: cookieName })
        });
        
        if (!response.ok) {
          throw new Error(`API returned ${response.status}`);
        }
        
        const data = await response.json();
        
        statusEl.remove();
        addStatus(`‚úÖ Successfully classified "${cookieName}"`, 'success');
        
        displaySingleResult(data);
      } catch (error) {
        statusEl.remove();
        addStatus(`Error: ${error.message}`, 'error');
      }
    }

    async function testCommonCookies() {
      const commonCookies = ['_ga', '_gid', 'sessionid', '_fbp', 'csrftoken', 'preferences', 'utm_campaign'];
      
      clearResults();
      addStatus(`Testing ${commonCookies.length} common cookies...`, 'info', true);
      
      try {
        const results = await Promise.all(
          commonCookies.map(async (name) => {
            const response = await fetch(`${API_URL}/predict`, {
              method: 'POST',
              headers: { 'Content-Type': 'application/json' },
              body: JSON.stringify({ cookie_name: name })
            });
            return response.json();
          })
        );
        
        addStatus(`‚úÖ Successfully classified ${results.length} cookies`, 'success');
        displayBatchResults(results);
      } catch (error) {
        addStatus(`Error: ${error.message}`, 'error');
      }
    }

    async function testBatch() {
      const batchCookies = [
        '_ga', '_gid', 'sessionid', '_fbp', '_fbc',
        'csrftoken', 'preferences', 'utm_campaign', 'utm_source', 'cookie_consent'
      ];
      
      clearResults();
      const statusEl = addStatus('Running batch prediction...', 'info', true);
      
      try {
        const response = await fetch(`${API_URL}/predict/batch`, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ cookie_names: batchCookies })
        });
        
        if (!response.ok) {
          throw new Error(`API returned ${response.status}`);
        }
        
        const data = await response.json();
        
        statusEl.remove();
        addStatus(`‚úÖ Batch prediction complete (${data.predictions.length} cookies)`, 'success');
        
        displayBatchResults(data.predictions);
      } catch (error) {
        statusEl.remove();
        addStatus(`Error: ${error.message}`, 'error');
      }
    }

    function displaySingleResult(data) {
      const card = document.createElement('div');
      card.className = 'result-card';
      
      const confidenceText = data.confidence 
        ? `<span class="confidence">${Math.round(data.confidence * 100)}% confidence</span>`
        : '';
      
      card.innerHTML = `
        <h3>Classification Result</h3>
        <div class="cookie-result class-${data.class_id}">
          <span style="font-size: 2rem;">${CATEGORY_ICONS[data.class_id]}</span>
          <span class="cookie-name">${data.cookie_name}</span>
          <span class="cookie-category category-${data.class_id}">${data.category}</span>
          ${confidenceText}
        </div>
        <pre>${JSON.stringify(data, null, 2)}</pre>
      `;
      
      resultsDiv.appendChild(card);
    }

    function displayBatchResults(predictions) {
      const card = document.createElement('div');
      card.className = 'result-card';
      
      const stats = {
        'Strictly Necessary': 0,
        'Functionality': 0,
        'Analytics': 0,
        'Advertising/Tracking': 0
      };
      
      predictions.forEach(p => stats[p.category]++);
      
      const resultsHTML = predictions.map(p => {
        const confidenceText = p.confidence 
          ? `<span class="confidence">${Math.round(p.confidence * 100)}%</span>`
          : '';
        
        return `
          <div class="cookie-result class-${p.class_id}">
            <span style="font-size: 1.5rem;">${CATEGORY_ICONS[p.class_id]}</span>
            <span class="cookie-name">${p.cookie_name}</span>
            <span class="cookie-category category-${p.class_id}">${p.category}</span>
            ${confidenceText}
          </div>
        `;
      }).join('');
      
      card.innerHTML = `
        <h3>Batch Results (${predictions.length} cookies)</h3>
        <div style="margin-bottom: 20px; padding: 15px; background: rgba(10, 12, 32, 0.5); border-radius: 8px;">
          <strong>Distribution:</strong><br>
          üîí Strictly Necessary: ${stats['Strictly Necessary']}<br>
          ‚öôÔ∏è Functionality: ${stats['Functionality']}<br>
          üìä Analytics: ${stats['Analytics']}<br>
          üéØ Advertising/Tracking: ${stats['Advertising/Tracking']}
        </div>
        ${resultsHTML}
      `;
      
      resultsDiv.appendChild(card);
    }

    // Auto-test on load
    window.addEventListener('DOMContentLoaded', () => {
      addStatus('Ready to test! Click "Health Check" to verify API is running.', 'info');
    });
  </script>
</body>
</html>
